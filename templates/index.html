    <!DOCTYPE html>
    <html lang="vi">
    <head>
        <meta charset="UTF-8">
        <title>D·ª± ƒëo√°n Ung th∆∞ C·ªï t·ª≠ cung</title>
        <link rel="stylesheet" href="/static/style.css">
    </head>
    <body>
    <div class="container">
        <h1>D·ª± ƒëo√°n nguy c∆° Ung th∆∞ C·ªï t·ª≠ cung</h1>
      

    <form method="POST">
        <!-- Grid 2 c·ªôt -->
        <div class="form-grid">
            {% set binary_features = [
                'Smokes', 'Hormonal Contraceptives', 'IUD', 'STDs',
                'STDs:condylomatosis', 'STDs:cervical condylomatosis',
                'STDs:vaginal condylomatosis', 'STDs:vulvo-perineal condylomatosis',
                'STDs:syphilis', 'STDs:pelvic inflammatory disease',
                'STDs:genital herpes', 'STDs:molluscum contagiosum',
                'STDs:AIDS', 'STDs:HIV', 'STDs:Hepatitis B', 'STDs:HPV',
                'Dx:Cancer', 'Dx:CIN', 'Dx:HPV', 'Dx',
                'Hinselmann', 'Schiller', 'Citology', 'Biopsy'
            ] %}

            {% set label_mapping = {
                'Age': 'Tu·ªïi',
                'Number of sexual partners': 'S·ªë b·∫°n t√¨nh',
                'First sexual intercourse': 'Tu·ªïi quan h·ªá l·∫ßn ƒë·∫ßu',
                'Num of pregnancies': 'S·ªë l·∫ßn mang thai',
                'Smokes': 'C√≥ h√∫t thu·ªëc',
                'Smokes (years)': 'S·ªë nƒÉm h√∫t thu·ªëc',
                'Smokes (packs/year)': 'S·ªë g√≥i m·ªói nƒÉm',
                'Hormonal Contraceptives': 'D√πng thu·ªëc tr√°nh thai',
                'Hormonal Contraceptives (years)': 'S·ªë nƒÉm d√πng thu·ªëc tr√°nh thai',
                'IUD': 'ƒê·∫∑t v√≤ng',
                'IUD (years)': 'S·ªë nƒÉm ƒë·∫∑t v√≤ng',
                'STDs': 'T·ª´ng m·∫Øc b·ªánh STDs',
                'STDs (number)': 'S·ªë l·∫ßn m·∫Øc STDs',
                'STDs:condylomatosis': 'S√πi m√†o g√†',
                'STDs:cervical condylomatosis': 'S√πi m√†o g√† c·ªï t·ª≠ cung',
                'STDs:vaginal condylomatosis': 'S√πi m√†o g√† √¢m ƒë·∫°o',
                'STDs:vulvo-perineal condylomatosis': 'S√πi m√†o g√† √¢m h·ªô - t·∫ßng sinh m√¥n',
                'STDs:syphilis': 'B·ªánh giang mai',
                'STDs:pelvic inflammatory disease': 'Vi√™m v√πng ch·∫≠u',
                'STDs:genital herpes': 'M·ª•n r·ªôp sinh d·ª•c',
                'STDs:molluscum contagiosum': 'U m·ªÅm l√¢y',
                'STDs:AIDS': 'AIDS',
                'STDs:HIV': 'HIV',
                'STDs:Hepatitis B': 'Vi√™m gan B',
                'STDs:HPV': 'Nhi·ªÖm HPV',
                'STDs: Number of diagnosis': 'S·ªë l·∫ßn ƒë∆∞·ª£c ch·∫©n ƒëo√°n STDs',
                'STDs: Time since first diagnosis': 'Th·ªùi gian t·ª´ l·∫ßn ch·∫©n ƒëo√°n STDs ƒë·∫ßu ti√™n',
                'STDs: Time since last diagnosis': 'Th·ªùi gian t·ª´ l·∫ßn ch·∫©n ƒëo√°n STDs g·∫ßn nh·∫•t',
                'Dx:Cancer': 'T·ª´ng ƒë∆∞·ª£c ch·∫©n ƒëo√°n ung th∆∞',
                'Dx:CIN': 'T·ª´ng ƒë∆∞·ª£c ch·∫©n ƒëo√°n CIN',
                'Dx:HPV': 'T·ª´ng ƒë∆∞·ª£c ch·∫©n ƒëo√°n HPV',
                'Dx': 'T·ª´ng c√≥ ch·∫©n ƒëo√°n b·∫•t th∆∞·ªùng',
                'Hinselmann': 'K·∫øt qu·∫£ Hinselmann d∆∞∆°ng t√≠nh',
                'Schiller': 'K·∫øt qu·∫£ Schiller d∆∞∆°ng t√≠nh',
                'Citology': 'K·∫øt qu·∫£ t·∫ø b√†o h·ªçc d∆∞∆°ng t√≠nh',
                'Biopsy': 'Sinh thi·∫øt d∆∞∆°ng t√≠nh'
            } %}

            {% for name in features %}
            <div class="form-group">
                <label>{{ label_mapping[name] }}</label>
                {% if name in binary_features %}
                    <select name="{{ name }}" required>
                        <option value="0">Kh√¥ng</option>
                        <option value="1">C√≥</option>
                    </select>
                {% else %}
                    <input type="number" step="any" name="{{ name }}" required>
                {% endif %}
            </div>
            {% endfor %}
        </div>

        <!-- N√∫t -->
        <button type="submit">D·ª± ƒëo√°n</button>
        <button type="button" onclick="fillLowRisk()">M·∫´u Nguy c∆° Th·∫•p</button>
        <button type="button" onclick="fillHighRisk()">M·∫´u Nguy c∆° Cao</button>
    </form>


    
    </div>

    <script>
    function fillFormByName(data) {
        Object.entries(data).forEach(([key, value]) => {
            const input = document.querySelector(`[name="${key}"]`);
            if (input) {
                if (input.tagName === "SELECT") {
                    input.value = value === 1 ? "1" : "0";
                } else {
                    input.value = value;
                }
            }
        });
    }

    function fillLowRisk() {
        fillFormByName({
            "Age": 25,
            "Number of sexual partners": 1,
            "First sexual intercourse": 18,
            "Num of pregnancies": 0,
            "Smokes": 0,
            "Smokes (years)": 0,
            "Smokes (packs/year)": 0,
            "Hormonal Contraceptives": 1,
            "Hormonal Contraceptives (years)": 1,
            "IUD": 0,
            "IUD (years)": 0,
            "STDs": 0,
            "STDs (number)": 0,
            "STDs:condylomatosis": 0,
            "STDs:cervical condylomatosis": 0,
            "STDs:vaginal condylomatosis": 0,
            "STDs:vulvo-perineal condylomatosis": 0,
            "STDs:syphilis": 0,
            "STDs:pelvic inflammatory disease": 0,
            "STDs:genital herpes": 0,
            "STDs:molluscum contagiosum": 0,
            "STDs:AIDS": 0,
            "STDs:HIV": 0,
            "STDs:Hepatitis B": 0,
            "STDs:HPV": 0,
            "STDs: Number of diagnosis": 0,
            "STDs: Time since first diagnosis": 0,
            "STDs: Time since last diagnosis": 0,
            "Dx:Cancer": 0,
            "Dx:CIN": 0,
            "Dx:HPV": 0,
            "Dx": 0,
            "Hinselmann": 0,
            "Schiller": 0,
            "Citology": 0,
            "Biopsy": 0
        });
    }

    function fillHighRisk() {
        fillFormByName({
            "Age": 45,
            "Number of sexual partners": 6,
            "First sexual intercourse": 15,
            "Num of pregnancies": 3,
            "Smokes": 1,
            "Smokes (years)": 10,
            "Smokes (packs/year)": 5,
            "Hormonal Contraceptives": 0,
            "Hormonal Contraceptives (years)": 0,
            "IUD": 1,
            "IUD (years)": 5,
            "STDs": 1,
            "STDs (number)": 2,
            "STDs:condylomatosis": 1,
            "STDs:cervical condylomatosis": 1,
            "STDs:vaginal condylomatosis": 0,
            "STDs:vulvo-perineal condylomatosis": 1,
            "STDs:syphilis": 0,
            "STDs:pelvic inflammatory disease": 1,
            "STDs:genital herpes": 0,
            "STDs:molluscum contagiosum": 0,
            "STDs:AIDS": 0,
            "STDs:HIV": 0,
            "STDs:Hepatitis B": 0,
            "STDs:HPV": 1,
            "STDs: Number of diagnosis": 5,
            "STDs: Time since first diagnosis": 3,
            "STDs: Time since last diagnosis": 1,
            "Dx:Cancer": 0,
            "Dx:CIN": 1,
            "Dx:HPV": 1,
            "Dx": 1,
            "Hinselmann": 1,
            "Schiller": 1,
            "Citology": 1,
            "Biopsy": 1
        });
    }

    function closeModal() {
        document.getElementById("resultModal").style.display = "none";
    }

    window.onclick = function(event) {
        const modal = document.getElementById("resultModal");
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }


    </script>
    <div id="resultModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>K·∫øt qu·∫£ d·ª± ƒëo√°n</h2>
            <div id="modalResultText"></div>
            <div id="modalAdviceBox" class="advice-box"></div>
            <img id="modalShapImage" src="" width="600px">
        </div>
    </div>
    {% if result is not none %}
    <script>
    document.addEventListener("DOMContentLoaded", function () {
        const resultText = `
            <p><strong>{{ "üî¥ Nguy c∆° cao m·∫Øc ung th∆∞ c·ªï t·ª≠ cung!" if result == 1 else "üü¢ Kh√¥ng c√≥ nguy c∆° ƒë√°ng k·ªÉ." }}</strong></p>
            <p>X√°c su·∫•t m√¥ h√¨nh d·ª± ƒëo√°n: <strong>{{ proba }}%</strong></p>
        `;
        const adviceText = `{{ advice | safe }}`;
        const shapPath = "{{ url_for('static', filename='shap_plot.png') }}";

        document.getElementById("modalResultText").innerHTML = resultText;
        document.getElementById("modalAdviceBox").innerHTML = adviceText;
        document.getElementById("modalShapImage").src = shapPath;

        // M·ªü modal
        document.getElementById("resultModal").style.display = "block";
    });
    </script>
    {% endif %}


    </body>
    </html>